row.names = c("AC","AE","AP","AU","AR","An","Ba","BC","BE","BM","BL","BP","Br","Be","Ce","CB","Ga",
              "Gr","Gx","Gi","Ma","Mo","No","Os","PJ","PS","PU","PE","Pr","RE","Ri","Se","Sg","Sv",
              "So","Ta","TA","Ur","VA","VO","VE")
data = matrix( c(9.62,1.90,11.30,11.10,6.84,9.89,49.14,0.20,
        8.42,2.26,14.39,15.73,13.77,10.02,34.50,0.91,
        9.08,1.88,13.76,11.55,7.51,6.86,49.23,0.14,
        10.39,1.80,11.15,13.62,10.65,14.26,37.08,1.05,
        13.90,1.83,7.78,10.41,15.81,12.95,37.25,0.08,
        8.79,1.95,11.01,11.31,7.66,3.57,55.57,0.14,
        11.28,1.84,11.66,12.75,8.22,3.15,50.79,0.31,
        12.15,2.11,13.14,14.98,11.13,6.97,39.29,0.23,
        10.85,1.70,10.26,12.46,8.85,16.34,39.25,0.29,
        8.22,2.16,10.87,14.33,13.56,8.03,42.46,0.37,
        5.80,1.88,14.68,12.59,11.71,1.22,51.99,0.13,
        7.95,2.28,12.14,14.22,12.55,5.59,44.91,0.35,
        17.13,2.90,21.37,14.81,11.16,0.40,32.07,0.15,
        10.14,1.21,8.91,11.48,8.35,8.33,51.01,0.58,
        9.96,2.35,9.36,13.75,15.92,13.57,34.33,0.77,
        8.62,1.90,9.73,9.66,7.47,16.34,46.18,0.11,
        20.60,3.25,20.22,22.91,21.04,4.94,6.79,0.25,
        7.90,1.16,7.68,9.07,6.22,34.27,33.51,0.19,
        10.14,2.07,10.96,10.82,7.54,6.71,51.58,0.17,
        14.18,2.30,17.22,13.90,9.94,3.35,38.60,0.52,
        11.85,3.21,13.90,14.37,10.03,4.16,42.30,0.17,
        6.98,1.48,8.41,10.75,7.32,24.11,40.54,0.40,
        7.32,1.20,6.02,7.93,5.33,20.80,51.18,0.23,
        9.94,1.83,10.70,11.00,6.57,6.24,53.62,0.10,
        12.36,1.72,10.44,10.14,8.94,20.82,33.36,2.20,
        13.43,1.29,9.59,7.10,14.72,23.84,29.74,0.29,
        8.25,1.62,9.74,9.75,5.71,24.57,40.15,0.23,
        10.95,2.22,12.29,10.45,6.96,9.54,47.50,0.09,
        8.68,1.03,7.41,7.72,7.02,32.16,35.67,0.30,
        12.39,0.99,9.06,8.70,7.84,17.45,43.21,0.36,
        9.24,1.76,8.26,10.09,9.18,7.31,53.91,0.25,
        9.93,1.90,9.91,8.50,6.30,17.49,45.89,0.09,
        13.03,2.13,13.76,13.78,10.39,14.42,31.53,0.96,
        7.33,1.96,10.84,12.46,15.20,5.67,46.36,0.17,
        10.15,1.44,7.77,7.42,8.20,21.20,43.67,0.14,
        14.22,2.12,16.61,12.89,12.91,2.90,37.73,0.61,
        4.83,0.91,4.90,7.21,4.65,39.10,38.05,0.36,
        9.06,2.09,9.76,12.70,6.73,17.68,41.72,0.28,
        11.18,6.90,10.84,13.64,21.30,5.42,29.52,1.21,
        12.05,2.27,14.64,13.20,8.97,0.68,48.09,0.10,
        9.32,2.19,13.22,11.33,8.19,2.44,53.19,0.12),ncol=8,byrow=TRUE)

X = data/100
n = nrow(X); p = ncol(X)
HD.dist = Acos.dist(X)

out = optim(par=rep(.5,p),fn=W.Euclidean.stress,X.mat=X,HD.dist=HD.dist,method="L-BFGS-B",
            lower=rep(0,p),upper=rep(10,p))
w.opt = out$par
D.curl = W.Euclidean(w.opt,X)

plot(HD.dist,D.curl)

Dr = diag(1/n,n)
Dr.inv = diag(n,n)
Dw = diag(w.opt)
Dw.inv = diag(1/w.opt)
S = sqrt(Dr)%*%scale(X,scale=FALSE)%*%sqrt(Dw)
svd.fit = svd(S)
U = svd.fit$u
Da = diag(svd.fit$d)
V = svd.fit$v
FF = sqrt(Dr.inv)%*%U%*%Da
A = sqrt(Dw.inv)%*%V
gamma = sqrt(Dw)%*%V

par(pty="s") 
plot(NA,NA,xlim=c(-1,.5),ylim=c(-.75,1))
text(FF[,1],FF[,2],labels=row.names,cex=.65)
segments(0,0,V[,1],V[,2])
